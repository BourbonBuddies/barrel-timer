<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Barrel Timer</title>
<style>
  body { margin:0; padding:0; background: url('barrel_background.png') center/cover fixed; }
  .timer { position:absolute; transform: translate(-50%,-50%); color:#f2e6d8; font-family:sans-serif; }
  .labels, .values { display:flex; justify-content:center; gap:8px; }
  .labels div { font-size:12px; }
  .values div { font-family:monospace; font-size:18px; }
  input { background:none; border:none; color:#f2e6d8; text-align:center; display:block; margin:2px auto; }
  button { background:none; border:none; color:#f2e6d8; font-size:18px; display:block; margin:2px auto; cursor:pointer; }
</style>
</head>
<body>
<div id="app"></div>
<script>
const coords=[{id:'A',x:218,y:261},{id:'B',x:669,y:261},{id:'C',x:1105,y:261},
              {id:'D',x:218,y:725},{id:'E',x:669,y:725},{id:'F',x:1105,y:725}];
coords.forEach(c=>{
  const t=document.createElement('div'); t.className='timer';
  const savedPos=localStorage.getItem('pos'+c.id);
  if(savedPos){
    const p=JSON.parse(savedPos);
    t.style.left=(p.x/window.innerWidth*100)+'%';
    t.style.top=(p.y/window.innerHeight*100)+'%';
  } else {
    t.style.left=(c.x/window.innerWidth*100)+'%';
    t.style.top=(c.y/window.innerHeight*100)+'%';
  }
  const title=document.createElement('input');
  title.type='text'; title.value=localStorage.getItem('title'+c.id)||('Barrel '+c.id);
  title.onchange=()=>localStorage.setItem('title'+c.id,title.value);
  const time=document.createElement('input');
  time.type='datetime-local';
  const st=localStorage.getItem('start'+c.id)||new Date().toISOString();
  time.value=st.slice(0,16);
  time.onchange=()=>localStorage.setItem('start'+c.id,new Date(time.value).toISOString());
  const labels=document.createElement('div'); labels.className='labels';
  ['Days','Hours','Min','Sec'].forEach(l=>{const d=document.createElement('div');d.innerText=l;labels.appendChild(d);});
  const vals=document.createElement('div'); vals.className='values'; vals.id='v'+c.id;
  ['000','00','00','00'].forEach(v=>{const d=document.createElement('div');d.innerText=v;vals.appendChild(d);});
  t.append(title,time,labels,vals);
  // drag
  let dx,dy;
  t.addEventListener('mousedown',e=>{
    if(localStorage.getItem('lock'+c.id)==='1')return;
    const r=t.getBoundingClientRect();
    dx=e.clientX-r.left; dy=e.clientY-r.top;
    const move=(e)=>{t.style.left=( (e.clientX-dx)/window.innerWidth*100)+'%';
                    t.style.top=( (e.clientY-dy)/window.innerHeight*100)+'%';};
    const up=()=>{
      document.removeEventListener('mousemove',move);
      document.removeEventListener('mouseup',up);
      const r2=t.getBoundingClientRect();
      localStorage.setItem('pos'+c.id,JSON.stringify({x:r2.left,y:r2.top}));
    };
    document.addEventListener('mousemove',move);
    document.addEventListener('mouseup',up);
  });
  // lock toggle
  const btn=document.createElement('button');
  btn.innerText=localStorage.getItem('lock'+c.id)==='1'?'ðŸ”’':'ðŸ”“';
  btn.onclick=()=>{
    const is=localStorage.getItem('lock'+c.id)==='1';
    localStorage.setItem('lock'+c.id,is?'0':'1');
    btn.innerText=is?'ðŸ”“':'ðŸ”’';
  };
  t.appendChild(btn);
  document.getElementById('app').appendChild(t);
  // timer update
  function upd(){
    const now=new Date();
    const st2=localStorage.getItem('start'+c.id)||now.toISOString();
    const diff=Math.floor((now-new Date(st2))/1000);
    const d=Math.floor(diff/86400),h=Math.floor(diff%86400/3600),
          m=Math.floor(diff%3600/60),s=diff%60;
    const arr=[String(d).padStart(3,'0'),String(h).padStart(2,'0'),
               String(m).padStart(2,'0'),String(s).padStart(2,'0')];
    const container=document.getElementById('v'+c.id);
    container.childNodes.forEach((n,i)=>n.innerText=arr[i]);
    requestAnimationFrame(upd);
  }
  upd();
});
window.addEventListener('resize',()=>location.reload());
</script>
</body>
</html>